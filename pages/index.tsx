import Head from 'next/head';
import PageLayout from '@components/structure/PageLayout';
import Button from '@components/primitive/Button';
import { FaPlus } from 'react-icons/fa';
import { useCreateUserMutation, useGetAllUsersQuery } from 'generated/graphql';

export default function Home() {
  const [result] = useGetAllUsersQuery();
  const [mutationResult, executeMutation] = useCreateUserMutation();
  console.log('mutationResult: ', mutationResult);
  console.log('executeMutation: ', executeMutation);

  const { data, fetching, error } = result;
  const { data: d, fetching: f, error: e } = mutationResult;

  if (fetching) return <p>Loading...</p>;
  if (error) return <p>Oh no... {error.message}</p>;

  return (
    <>
      <Head>
        <title>Unibiz</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <PageLayout>
        <Button
          onClick={() =>
            executeMutation({
              email: 'email10000@gmail.com',
              password: 'password',
              firstName: 'Michael',
              lastName: 'Taiwo',
            })
          }
        >
          Create User
          <FaPlus />
        </Button>
        <p>
          Mutation result: <span>{JSON.stringify(d)}</span>
        </p>
        <ul>
          {data?.User?.map((user: any) => (
            <li key={user.id}>{user.email}</li>
          ))}
        </ul>
      </PageLayout>
    </>
  );
}
